<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProtoDynamics Advanced Materials Demo v2.0</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.167.1/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.167.1/examples/js/controls/OrbitControls.js"></script>
    <style>
        body { margin: 0; background: #0a0a1a; color: #e0e0ff; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        #container { position: relative; width: 100vw; height: 100vh; }
        #ui { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
        .overlay { position: absolute; background: rgba(10,10,30,0.85); padding: 20px; border-radius: 10px; pointer-events: auto; }
        #header { top: 20px; left: 50%; transform: translateX(-50%); text-align: center; max-width: 800px; }
        #tabs { top: 160px; left: 50%; transform: translateX(-50%); display: flex; gap: 15px; }
        .tab { padding: 12px 24px; background: #1a1a3a; border: 1px solid #4a4a8a; border-radius: 8px; cursor: pointer; transition: 0.3s; }
        .tab.active { background: #3a6dff; border-color: #6a9fff; }
        #grid { top: 220px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 1200px; display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; max-height: 70vh; overflow-y: auto; padding: 20px; background: rgba(15,15,40,0.6); border-radius: 10px; }
        .card { background: #1a1a3a; border: 1px solid #4a4a8a; border-radius: 10px; padding: 15px; cursor: pointer; transition: 0.3s; }
        .card:hover { background: #2a2a5a; transform: translateY(-5px); }
        .badge { background: #0a8020; color: white; padding: 4px 10px; border-radius: 20px; font-size: 0.8em; display: inline-block; margin-top: 8px; }
        #detail { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; flex-direction: row; }
        #detail-left { width: 50%; height: 100%; display: flex; align-items: center; justify-content: center; position: relative; }
        #detail-right { width: 50%; padding: 40px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #4a4a8a; }
        th { background: #1a1a3a; }
        #log { background: #111133; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 0.9em; height: 200px; overflow-y: auto; margin-top: 20px; }
        #play { padding: 10px 20px; background: #3a6dff; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 20px; }
        #close { position: absolute; top: 20px; right: 20px; font-size: 30px; cursor: pointer; }
        h1 { margin: 0; font-size: 2.5em; }
        h2 { margin: 10px 0; }
        p { line-height: 1.6; }
        .process { margin-top: 20px; font-style: italic; color: #aaa; }
    </style>
</head>
<body>
    <div id="container">
        <div id="ui">
            <div id="header" class="overlay">
                <h1>ProtoDynamics Advanced Materials Demo v2.0</h1>
                <p>Interactive preview of 30 proprietary material systems.<br>All results achievable with existing CVD PECVD and MesoScribe technology.<br>Full synthesis details available under mutual NDA.</p>
            </div>
            <div id="tabs" class="overlay">
                <div class="tab active" data-cat="hydro">Hydrocarbon Perfection (10)</div>
                <div class="tab" data-cat="metalglass">Metal & Glass Perfection (10)</div>
                <div class="tab" data-cat="thermal">Thermal-Spray Quasicrystals (10)</div>
            </div>
            <div id="grid" class="overlay"></div>
        </div>
        <div id="detail">
            <div id="detail-left"><div id="scene"></div></div>
            <div id="detail-right">
                <span id="close">&times;</span>
                <h2 id="detail-title"></h2>
                <p id="detail-desc"></p>
                <button id="play">Run Simulation</button>
                <div id="log"></div>
                <div id="detail-table"></div>
                <p class="process" id="detail-process"></p>
                <p style="margin-top:20px;font-size:0.9em;color:#aaa;">Proprietary Alignment Achieved – Full process under NDA</p>
            </div>
        </div>
    </div>

    <script>
        const ranks = {
            hydro: [
                {id:901,name:"Methane Perfection",desc:"Ultra-clean combustion, perfect CH₄ chain ordering",before:{eff:"32%",hc:"High"},after:{eff:"70%+",hc:"Near Zero",harvest:"45 kg/1000 km graphite"},process:"PECVD-synthesized nano-powder drop-in to natural gas streams for chain ordering perfection."},
                {id:902,name:"Octane Perfection",desc:"Infinite knock margin gasoline additive",before:{eff:"38%",hc:"High"},after:{eff:"75%+",hc:"Near Zero",harvest:"55 kg/1000 km graphite"},process:"Superparamagnetic nano-catalyst blended at refinery for gasoline zero-slack matrix."},
                // ... (same for others, add process text to each)
                {id:910,name:"Gasoline Blend Perfection",desc:"Universal pump gasoline enhancement",before:{eff:"38%"},after:{eff:"75%+",harvest:"55 kg/1000 km"},process:"Drop-in powder for refinery blending to achieve perfect hydrocarbon alignment."}
            ],
            // Add process to metalglass and thermal similarly, e.g., for glass: "Nano-powder additive to molten glass bath for bubble-free perfection."
            // For thermal: "MesoScribe plasma-spray deposition of quasicrystal precursors for low-friction coating."
            // Abbreviated for brevity; full list as in v1
        };  // Extend with full ranks from v1, adding 'process' key to each

        let currentCat = 'hydro';
        let scene, renderer, camera, controls, currentMesh;

        function init3D() {
            // same as v1
        }

        function animate() {
            // same as v1
        }

        function createLattice(type, state = 'before') {
            while(scene.children.length > 2) scene.remove(scene.children[2]);
            // same as v1, but add "乱" for before state (e.g., random offsets for inclusions/bubbles)
            if (state === 'before') {
                // Add 'defects' like extra spheres for inclusions or bubbles
                for (let i = 0; i < 5; i++) {
                    const defect = new THREE.Mesh(new THREE.SphereGeometry(0.2), new THREE.MeshStandardMaterial({color: 0xff0000}));
                    defect.position.set(Math.random()*2-1, Math.random()*2-1, Math.random()*2-1);
                    scene.add(defect);
                }
            }
            // Normal lattice as in v1
            // For 'after', no defects, colors brighter
        }

        function buildGrid(cat) {
            // same as v1
        }

        function showDetail(rank, vizType) {
            // same as v1
            document.getElementById('detail-process').textContent = rank.process;
            document.getElementById('log').innerHTML = '';
            document.getElementById('detail-table').innerHTML = ''; // Show table after simulation
            createLattice(vizType, 'before');
            document.getElementById('play').onclick = () => runSimulation(rank, vizType);
        }

        function runSimulation(rank, vizType) {
            const log = document.getElementById('log');
            log.innerHTML = '> SYSTEM INITIALIZED\n';
            setTimeout(() => log.innerHTML += '> CATALYST LOADED\n', 1000);
            setTimeout(() => log.innerHTML += '> LATTICE OPTIMIZING...\n', 2000);
            setTimeout(() => {
                createLattice(vizType, 'after');
                log.innerHTML += '> PERFECTION ACHIEVED\n';
                // Show table
                let table = '<table><tr><th>Property</th><th>Conventional</th><th>Perfected System</th><th>Improvement</th></tr>';
                // same table generation as v1
                document.getElementById('detail-table').innerHTML = table;
            }, 3000);
        }

        // Rest of script same as v1
        init3D();
        buildGrid('hydro');
    </script>
</body>
</html>
