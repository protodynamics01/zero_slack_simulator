<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRAVES VALIDATION SUITE v33.0 | 40 SYSTEMS</title>
    <style>
        :root { --cyan: #00ffcc; --red: #ff3333; --gold: #ffaa00; --bg: #050505; }
        * { box-sizing: border-box; user-select: none; }
        body { margin: 0; background: #000; color: #e0e0e0; font-family: system-ui, sans-serif; height: 100vh; overflow: hidden; display: grid; grid-template-rows: 40px 1fr; }
        header { background: rgba(0,0,0,0.9); border-bottom: 1px solid rgba(0,255,204,0.2); display: flex; justify-content: space-between; align-items: center; padding: 0 15px; font-size: 0.75em; font-weight: 700; letter-spacing: 2px; }
        .clock-ref { font-family: monospace; font-size: 0.85em; color: #666; }
        .clock-live { color: var(--cyan); margin-left: 10px; }
        #workspace { display: grid; grid-template-columns: 320px 1fr 280px; height: calc(100vh - 40px); overflow: hidden; }
        .panel { background: rgba(10,15,20,0.98); border-right: 1px solid rgba(0,255,204,0.2); padding: 10px; display: flex; flex-direction: column; gap: 6px; overflow-y: auto; }
        .panel-right { border-right: none; border-left: 1px solid rgba(0,255,204,0.2); }
        h2 { margin: 0 0 6px 0; font-size: 0.7em; color: #888; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #333; padding-bottom: 4px; }
        #inv-list { height: 80px; overflow-y: auto; border: 1px solid #333; background: #000; font-family: monospace; font-size: 0.6em; }
        .inv-item { padding: 6px 8px; border-bottom: 1px solid #222; cursor: pointer; color: #666; display: flex; }
        .inv-item:hover { background: rgba(0,255,204,0.1); color: #fff; }
        .inv-item.active { background: var(--cyan); color: #000; font-weight: bold; }
        .inv-id { color: #444; margin-right: 10px; font-weight: bold; min-width: 30px; }
        .inv-item.active .inv-id { color: #000; }
        .input-group { margin-bottom: 6px; }
        label { display: block; font-size: 0.65em; color: #666; margin-bottom: 2px; font-family: monospace; }
        input, textarea { width: 100%; background: #111; border: 1px solid #333; color: var(--cyan); padding: 6px; font-family: monospace; font-size: 0.8em; outline: none; resize: none; }
        .selector-row { display: flex; gap: 4px; margin-bottom: 8px; }
        .sel-btn { flex: 1; padding: 6px 4px; background: rgba(255,255,255,0.05); border: 1px solid #333; color: #666; font-size: 0.55em; font-weight: bold; cursor: pointer; text-align: center; }
        .sel-btn:hover { background: rgba(255,255,255,0.1); color: #aaa; }
        .sel-btn.active { background: rgba(0,255,204,0.15); border-color: var(--cyan); color: var(--cyan); }
        #stage { position: relative; display: flex; flex-direction: column; padding: 10px; gap: 8px; background: radial-gradient(circle at center, #111 0%, #000 100%); }
        .graph-box { background: rgba(0,0,0,0.5); border: 1px solid #333; position: relative; padding: 8px; display: flex; flex-direction: column; }
        .graph-box.scanner { height: 120px; }
        .graph-box.lattice { flex: 1; min-height: 200px; }
        .graph-header { position: absolute; top: 6px; left: 8px; font-size: 0.6em; color: var(--cyan); font-weight: bold; z-index: 10; }
        .lock-indicator { position: absolute; top: 6px; right: 8px; font-size: 0.6em; color: #555; font-weight: bold; z-index: 10; }
        button#btn-action { width: 100%; padding: 12px; background: rgba(0,255,204,0.1); border: 1px solid var(--cyan); color: var(--cyan); font-weight: 700; letter-spacing: 1px; cursor: pointer; text-transform: uppercase; margin-top: 4px; font-size: 0.75em; }
        button#btn-action:hover { background: var(--cyan); color: #000; }
        button#btn-action:disabled { border-color: #333; color: #555; background: transparent; cursor: not-allowed; }
        button#btn-action.fabricate { border-color: var(--gold); color: var(--gold); background: rgba(255,170,0,0.1); }
        button#btn-action.fabricate:hover { background: var(--gold); color: #000; }
        button#btn-action.reset { border-color: var(--red); color: var(--red); background: rgba(255,51,51,0.1); }
        #console { height: 60px; background: #000; border: 1px solid #333; font-family: monospace; font-size: 0.6em; color: #888; padding: 6px; overflow-y: auto; white-space: pre-wrap; }
        .log-cyan { color: var(--cyan); }
        .log-red { color: var(--red); }
        .log-gold { color: var(--gold); }
        #scan-line { position: absolute; top: 0; left: 0; width: 2px; height: 100%; background: var(--cyan); box-shadow: 0 0 10px var(--cyan); opacity: 0; pointer-events: none; z-index: 5; }
        canvas { width: 100%; height: 100%; display: block; }
        #monitor-panel { display: flex; height: 90px; background: rgba(0,0,0,0.9); border-top: 1px solid #333; }
        .monitor-box { flex: 1; border-right: 1px solid #333; padding: 6px; position: relative; display: flex; flex-direction: column; }
        .monitor-box:last-child { border-right: none; }
        .monitor-label { font-size: 0.5em; color: #666; font-weight: bold; margin-bottom: 2px; }
        .monitor-value { position: absolute; top: 4px; right: 6px; font-size: 0.5em; font-family: monospace; font-weight: bold; }
        .monitor-canvas { flex: 1; }
    </style>
</head>
<body>
<header>
    <div>GRAVES VALIDATION SUITE <span style="color:#666">// v33.0 | 40 SYSTEMS</span></div>
    <div id="industry-indicator" style="color:var(--gold); font-size:0.85em; font-family:monospace;"></div>
    <div class="clock-ref">DEUTERIUM REF: <span class="clock-live">327.384 MHz</span></div>
</header>
<div id="workspace">
    <div class="panel">
        <h2>1. Select System</h2>
        <div id="inv-list"></div>
        <h2>2. Industry</h2>
        <div class="selector-row" id="industry-selector">
            <div class="sel-btn active" data-ind="ALL" onclick="setIndustry('ALL')">ALL</div>
            <div class="sel-btn" data-ind="AERO" onclick="setIndustry('AERO')">AERO</div>
            <div class="sel-btn" data-ind="DEFENSE" onclick="setIndustry('DEFENSE')">DEF</div>
            <div class="sel-btn" data-ind="INDUSTRIAL" onclick="setIndustry('INDUSTRIAL')">IND</div>
            <div class="sel-btn" data-ind="HYDRO" onclick="setIndustry('HYDRO')">HYDRO</div>
        </div>
        <h2>3. Environment</h2>
        <div class="selector-row" id="temp-selector">
            <div class="sel-btn active" data-temp="ROOM" onclick="setTemp('ROOM')">ROOM (300K)</div>
            <div class="sel-btn" data-temp="CRYO" onclick="setTemp('CRYO')">CRYO (4K)</div>
        </div>
        <button id="btn-action" disabled>SELECT A SYSTEM</button>
        <h2>4. Composition</h2>
        <div class="input-group"><label>PRIMARY ELEMENTS</label><input type="text" id="comp-elements" readonly></div>
        <div class="input-group"><label>LATTICE SYMMETRY</label><input type="text" id="lattice-type" readonly></div>
        <div class="input-group"><label>WAAM (g/mol)</label><div id="mass-readout" style="color:#fff; font-family:monospace; font-size:0.75em; padding:4px; background:#111; border:1px solid #333;">--</div></div>
        <h2>5. Patent Claim</h2>
        <textarea id="comp-detail" rows="8" readonly style="font-size:0.55em; color:#aaa; flex:1; min-height:100px;"></textarea>
    </div>
    <div id="stage">
        <div class="graph-box scanner">
            <div class="graph-header">HYPERFINE LOCK SCANNER (5.030° – 5.045°)</div>
            <div class="lock-indicator" id="lock-indicator">STANDBY</div>
            <canvas id="scanCanvas"></canvas>
            <div id="scan-line"></div>
        </div>
        <div class="graph-box lattice" id="atom-container">
            <div class="graph-header">3D ATOMIC LATTICE (LIVE RENDER)</div>
            <div id="lattice-state" style="position:absolute; top:6px; right:8px; font-size:0.55em; color:#ff3333; font-weight:bold;">DISORDERED</div>
            <canvas id="atomCanvas"></canvas>
        </div>
        <div id="monitor-panel">
            <div class="monitor-box"><div class="monitor-label">PHONON ENTROPY</div><div class="monitor-value" id="entropy-val" style="color:#ff3333;">8.274 eV</div><canvas id="entropyCanvas" class="monitor-canvas"></canvas></div>
            <div class="monitor-box"><div class="monitor-label">PHASE SPACE</div><div class="monitor-value" id="phase-val" style="color:#ff3333;">Δφ: 0.847</div><canvas id="phaseCanvas" class="monitor-canvas"></canvas></div>
            <div class="monitor-box"><div class="monitor-label">VACUUM FLUX</div><div class="monitor-value" id="vacuum-val" style="color:#ff3333;">2.14e-7 T</div><canvas id="vacuumCanvas" class="monitor-canvas"></canvas></div>
            <div class="monitor-box"><div class="monitor-label" style="color:var(--cyan);">DEUTERIUM CLOCK</div><canvas id="clockCanvas" class="monitor-canvas"></canvas><div style="position:absolute; bottom:3px; left:6px; right:6px; display:flex; justify-content:space-between; font-size:0.4em; font-family:monospace; color:#666;"><span>JIT: <span id="clk-jit" style="color:#ff3333;">HIGH</span></span><span>COH: <span id="clk-coh">0.12</span></span></div></div>
        </div>
    </div>
    <div class="panel panel-right">
        <h2>6. Lock Results</h2>
        <div class="input-group"><label>UNIQUE LOCK ANGLE (°)</label><input type="text" id="res-angle" readonly style="color:var(--gold); font-weight:bold; font-size:1em;"></div>
        <div class="input-group"><label>RESIDUAL SLACK</label><input type="text" id="res-slack" readonly style="color:var(--cyan);"></div>
        <h2>7. 2D Atomic Structure</h2>
        <div id="atomic-2d" style="background:#000; border:1px solid #333; padding:6px; flex:1; min-height:150px; display:flex; flex-direction:column;">
            <div id="element-list" style="color:#888; font-family:monospace; font-size:0.5em; margin-bottom:4px;">Select a system...</div>
            <canvas id="atomic2dCanvas" style="flex:1; width:100%; min-height:120px;"></canvas>
        </div>
        <h2>8. Validation Log</h2>
        <div id="console"></div>
    </div>
</div>
<script>
const PHI = 1.61803398874989484820458683436563811772030917980576;
const K_RAT = 686 / 461;
const ALPHA_OBS = 137.035999206;
const ALPHA_NATIVE = 166.083676989207;
const G_PHI = Math.pow(PHI, -12) * (Math.pow(PHI, 5) / 3) / K_RAT;
const THETA_BASE = Math.asin(Math.sqrt(G_PHI)) * (180 / Math.PI);
const WAAM_REF = 73.717;
const WAAM_SLOPE = 0.0000589;
const HYDRO_BASE = 5.039684;
const HYDRO_SLOPE = 0.0002655;

const ATOMIC_MASS = {“H”:1.00794,“He”:4.0026,“Li”:6.941,“Be”:9.0122,“B”:10.811,“C”:12.0107,“N”:14.0067,“O”:15.9994,“F”:18.9984,“Na”:22.9897,“Mg”:24.305,“Al”:26.9815,“Si”:28.0855,“P”:30.9738,“S”:32.065,“Cl”:35.453,“K”:39.0983,“Ca”:40.078,“Ti”:47.867,“V”:50.9415,“Cr”:51.9961,“Mn”:54.938,“Fe”:55.845,“Co”:58.9332,“Ni”:58.6934,“Cu”:63.546,“Zn”:65.38,“Zr”:91.224,“Nb”:92.9064,“Mo”:95.96,“Rh”:102.9055,“Ta”:180.9479,“W”:183.84,“Re”:186.207,“Os”:190.23,“Ir”:192.217,“Hf”:178.49,“Y”:88.9059,“Gd”:157.25};

const DB = {
“001”: {name:“Ni Superalloy Turbine Blade”,elements:[“Ni”,“Co”,“Cr”,“Al”,“Ti”,“Mo”,“W”,“Nb”],detail:“Ni-based single crystal superalloy for high-pressure turbine blades.”,lattice:“Icosahedral”,type:“metal”,industry:“AERO”},
“002”: {name:“Co Superalloy Turbine Disk”,elements:[“Co”,“Cr”,“Ni”,“W”,“Al”,“Ta”],detail:“Co-based superalloy for turbine disks.”,lattice:“Decagonal”,type:“metal”,industry:“AERO”},
“003”: {name:“Ti-Al Compressor Blade”,elements:[“Ti”,“Al”,“Nb”,“Cr”],detail:“Gamma titanium aluminide for compressor stages.”,lattice:“Pentagonal”,type:“metal”,industry:“AERO”},
“004”: {name:“W-Re Hypersonic Leading Edge”,elements:[“W”,“Re”,“Hf”,“C”],detail:“Tungsten-rhenium for Mach 10+ thermal protection.”,lattice:“Icosahedral”,type:“metal”,industry:“AERO”},
“005”: {name:“Ti-6Al-4V Structural”,elements:[“Ti”,“Al”,“V”],detail:“Aerospace-grade titanium alloy.”,lattice:“Decagonal”,type:“metal”,industry:“AERO”},
“006”: {name:“YSZ Thermal Barrier Coating”,elements:[“Zr”,“Y”,“Gd”,“O”],detail:“Yttria-stabilized zirconia with Gd doping.”,lattice:“Pentagonal”,type:“ceramic”,industry:“AERO”},
“007”: {name:“Co-Cr Naval Armor”,elements:[“Co”,“Cr”,“Ni”,“W”,“Al”,“Ta”],detail:“Naval armor plate with superior impact resistance.”,lattice:“Decagonal”,type:“metal”,industry:“DEFENSE”},
“008”: {name:“Fe-Si-B Stealth Coating”,elements:[“Fe”,“Si”,“B”],detail:“RF absorption coating for stealth.”,lattice:“Pentagonal”,type:“metal”,industry:“DEFENSE”},
“009”: {name:“B4C Ceramic Armor”,elements:[“B”,“C”],detail:“Boron carbide armor insert.”,lattice:“Icosahedral”,type:“ceramic”,industry:“DEFENSE”},
“010”: {name:“SiC Armor Plate”,elements:[“Si”,“C”],detail:“Silicon carbide armor.”,lattice:“Decagonal”,type:“ceramic”,industry:“DEFENSE”},
“011”: {name:“Al2O3 Ballistic Ceramic”,elements:[“Al”,“O”],detail:“Alumina armor ceramic.”,lattice:“Pentagonal”,type:“ceramic”,industry:“DEFENSE”},
“012”: {name:“TiB2 Ultra-Hard Armor”,elements:[“Ti”,“B”],detail:“Titanium diboride armor.”,lattice:“Icosahedral”,type:“ceramic”,industry:“DEFENSE”},
“013”: {name:“WC-Co Hard Facing”,elements:[“W”,“C”,“Co”],detail:“Tungsten carbide coating.”,lattice:“Icosahedral”,type:“metal”,industry:“INDUSTRIAL”},
“014”: {name:“TiN Tool Coating”,elements:[“Ti”,“N”],detail:“Titanium nitride PVD coating.”,lattice:“Decagonal”,type:“ceramic”,industry:“INDUSTRIAL”},
“015”: {name:“TiAlN High-Temp Coating”,elements:[“Ti”,“Al”,“N”],detail:“Titanium aluminum nitride.”,lattice:“Pentagonal”,type:“ceramic”,industry:“INDUSTRIAL”},
“016”: {name:“CrN Corrosion Barrier”,elements:[“Cr”,“N”],detail:“Chromium nitride coating.”,lattice:“Icosahedral”,type:“ceramic”,industry:“INDUSTRIAL”},
“017”: {name:“DLC Diamond-Like Carbon”,elements:[“C”,“H”],detail:“Hydrogenated DLC coating.”,lattice:“Decagonal”,type:“ceramic”,industry:“INDUSTRIAL”},
“018”: {name:“Al2O3 CVD Coating”,elements:[“Al”,“O”],detail:“Alumina CVD for cutting tools.”,lattice:“Pentagonal”,type:“ceramic”,industry:“INDUSTRIAL”},
“019”: {name:“SiC-SiC CMC”,elements:[“Si”,“C”],detail:“Ceramic matrix composite.”,lattice:“Decagonal”,type:“ceramic”,industry:“INDUSTRIAL”},
“020”: {name:“YSZ Thermal Barrier”,elements:[“Zr”,“Y”,“O”],detail:“Yttria-stabilized zirconia TBC.”,lattice:“Pentagonal”,type:“ceramic”,industry:“INDUSTRIAL”},
“101”: {name:“C1 Methane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“CH4 natural gas. 100% combustion.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“CH₄”,carbonNum:1},
“102”: {name:“C2 Ethane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C2H6 ethane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₂H₆”,carbonNum:2},
“103”: {name:“C3 Propane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C3H8 LPG propane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₃H₈”,carbonNum:3},
“104”: {name:“C4 Butane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C4H10 butane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₄H₁₀”,carbonNum:4},
“105”: {name:“C5 Pentane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C5H12 pentane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₅H₁₂”,carbonNum:5},
“106”: {name:“C6 Hexane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C6H14 hexane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₆H₁₄”,carbonNum:6},
“107”: {name:“C7 Heptane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C7H16 heptane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₇H₁₆”,carbonNum:7},
“108”: {name:“C8 Octane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C8H18 isooctane. 35:1 compression.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₈H₁₈”,carbonNum:8},
“109”: {name:“C9 Nonane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C9H20 nonane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₉H₂₀”,carbonNum:9},
“110”: {name:“C10 Decane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C10H22 decane. Jet fuel.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₀H₂₂”,carbonNum:10},
“111”: {name:“C11 Undecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C11H24 undecane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₁H₂₄”,carbonNum:11},
“112”: {name:“C12 Dodecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C12H26 dodecane. RP-1.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₂H₂₆”,carbonNum:12},
“113”: {name:“C13 Tridecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C13H28 tridecane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₃H₂₈”,carbonNum:13},
“114”: {name:“C14 Tetradecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C14H30 tetradecane. Jet-A.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₄H₃₀”,carbonNum:14},
“115”: {name:“C15 Pentadecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C15H32 pentadecane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₅H₃₂”,carbonNum:15},
“116”: {name:“C16 Cetane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C16H34 cetane. Diesel ref.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₆H₃₄”,carbonNum:16},
“117”: {name:“C17 Heptadecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C17H36 heptadecane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₇H₃₆”,carbonNum:17},
“118”: {name:“C18 Octadecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C18H38 octadecane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₈H₃₈”,carbonNum:18},
“119”: {name:“C19 Nonadecane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C19H40 nonadecane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₁₉H₄₀”,carbonNum:19},
“120”: {name:“C20 Icosane Catalyst”,elements:[“Ir”,“Os”,“Rh”,“B”],detail:“C20H42 icosane.”,lattice:“Icosahedral”,type:“catalyst”,industry:“HYDRO”,molecular:“C₂₀H₄₂”,carbonNum:20}
};

const ELEMENT_COLORS = {“H”:”#FFFFFF”,“B”:”#FFB5B5”,“C”:”#909090”,“N”:”#3050F8”,“O”:”#FF0D0D”,“Al”:”#BFA6A6”,“Si”:”#F0C8A0”,“Ti”:”#BFC2C7”,“V”:”#A6A6AB”,“Cr”:”#8A99C7”,“Fe”:”#E06633”,“Co”:”#F090A0”,“Ni”:”#50D050”,“Zr”:”#94E0E0”,“Nb”:”#73C2C9”,“Mo”:”#54B5B5”,“Rh”:”#0A7D8C”,“Ta”:”#4DA6FF”,“W”:”#2194D6”,“Re”:”#267DAB”,“Os”:”#266696”,“Ir”:”#175487”,“Hf”:”#4DC2FF”,“Y”:”#94FFFF”,“Gd”:”#45FFC7”};

function calculateWAAM(elements) {
let total = 0, count = 0;
elements.forEach(el => { if(ATOMIC_MASS[el]) { total += ATOMIC_MASS[el]; count++; } });
return count > 0 ? total / count : 0;
}

function calculateLockAngle(id, data) {
let angle, waam, formula;
if (data.type === “catalyst” && data.carbonNum !== undefined) {
const n = data.carbonNum;
angle = HYDRO_BASE - (HYDRO_SLOPE * n);
waam = 12.0107 * n + 1.00794 * (2 * n + 2);
formula = `θ = ${HYDRO_BASE} - ${HYDRO_SLOPE} × ${n}`;
} else {
waam = calculateWAAM(data.elements);
angle = THETA_BASE + (waam - WAAM_REF) * WAAM_SLOPE;
formula = `θ = ${THETA_BASE.toFixed(6)}° + (${waam.toFixed(3)} - ${WAAM_REF}) × ${WAAM_SLOPE}`;
}
angle = Math.max(5.030, Math.min(5.045, angle));
return { angle, waam, formula };
}

let currentRank = null, isLocked = false, uniqueAngle = 0, atoms = [], chaosMode = true, transitionProgress = 0, orderedPositions = [], currentIndustry = ‘ALL’, currentTemp = ‘ROOM’, tempK = 300;
const invList = document.getElementById(‘inv-list’);
const scanCtx = document.getElementById(‘scanCanvas’).getContext(‘2d’);
const atomCtx = document.getElementById(‘atomCanvas’).getContext(‘2d’);
const consoleDiv = document.getElementById(‘console’);
let entropyCtx, phaseCtx, vacuumCtx, clockCtx;
let waveData = { entropy: [], vacuum: [] };

function setIndustry(ind) {
currentIndustry = ind;
document.querySelectorAll(’#industry-selector .sel-btn’).forEach(b => b.classList.remove(‘active’));
document.querySelector(`#industry-selector .sel-btn[data-ind="${ind}"]`).classList.add(‘active’);
document.getElementById(‘industry-indicator’).innerText = ind === ‘ALL’ ? ‘’ : ind;
populateList();
}

function setTemp(temp) {
currentTemp = temp; tempK = temp === ‘CRYO’ ? 4 : 300;
document.querySelectorAll(’#temp-selector .sel-btn’).forEach(b => b.classList.remove(‘active’));
document.querySelector(`#temp-selector .sel-btn[data-temp="${temp}"]`).classList.add(‘active’);
if (currentRank) log(`ENV: ${temp} (${tempK}K)`, temp === ‘CRYO’ ? ‘cyan’ : ‘gold’);
}

function populateList() {
invList.innerHTML = ‘’;
Object.keys(DB).sort((a,b) => parseInt(a) - parseInt(b)).forEach(key => {
const data = DB[key];
if (currentIndustry !== ‘ALL’ && data.industry !== currentIndustry) return;
let el = document.createElement(‘div’);
el.className = ‘inv-item’; el.dataset.id = key;
el.innerHTML = `<span class="inv-id">${key}</span><span>${data.name}</span>`;
el.onclick = () => selectRank(key);
invList.appendChild(el);
});
}

function setButtonState(state) {
const btn = document.getElementById(‘btn-action’);
btn.className = ‘’;
if(state===“disabled”) { btn.disabled = true; btn.innerText = “SELECT A SYSTEM”; btn.onclick = null; }
else if(state===“scan”) { btn.disabled = false; btn.innerText = “▶ INITIATE TORSION SCAN”; btn.onclick = runScan; }
else if(state===“scanning”) { btn.disabled = true; btn.innerText = “⟳ SCANNING…”; }
else if(state===“fabricate”) { btn.disabled = false; btn.className = ‘fabricate’; btn.innerText = “⚙ EXPORT FABRICATION”; btn.onclick = exportFabrication; }
else if(state===“reset”) { btn.disabled = false; btn.className = ‘reset’; btn.innerText = “↺ RESET”; btn.onclick = doReset; }
}

function doReset() {
document.getElementById(‘res-angle’).value = “–”;
document.getElementById(‘res-slack’).value = “–”;
document.getElementById(‘lock-indicator’).innerText = “READY”;
document.getElementById(‘lock-indicator’).style.color = “#555”;
document.getElementById(‘lattice-state’).innerText = “DISORDERED”;
document.getElementById(‘lattice-state’).style.color = “#ff3333”;
isLocked = false; chaosMode = true; transitionProgress = 0;
waveData = { entropy: [], vacuum: [] };
atoms.forEach(a => { a.vx = (Math.random()-0.5)*8; a.vy = (Math.random()-0.5)*8; a.vz = (Math.random()-0.5)*8; });
drawGrid(scanCtx);
setButtonState(“scan”);
log(“SYSTEM RESET.”, “cyan”);
}

function init() {
populateList(); resize();
window.addEventListener(‘resize’, resize);
initAtoms();
requestAnimationFrame(drawLoop);
setTimeout(() => { initMonitors(); drawMonitors(); }, 100);
log(“GRAVES VALIDATION SUITE v33.0”, “cyan”);
log(“40-SYSTEM DATABASE LOADED.”, “gold”);
log(`θ_base = ${THETA_BASE.toFixed(6)}°`, “gold”);
}

function resize() {
scanCtx.canvas.width = scanCtx.canvas.offsetWidth;
scanCtx.canvas.height = scanCtx.canvas.offsetHeight;
atomCtx.canvas.width = atomCtx.canvas.offsetWidth;
atomCtx.canvas.height = atomCtx.canvas.offsetHeight;
drawGrid(scanCtx);
const canvas2d = document.getElementById(‘atomic2dCanvas’);
if(canvas2d && canvas2d.offsetWidth > 0) {
canvas2d.width = canvas2d.offsetWidth;
canvas2d.height = canvas2d.offsetHeight || 120;
if (currentRank) draw2DStructure(DB[currentRank]);
}
initMonitors();
}

function selectRank(id) {
currentRank = id;
const data = DB[id];
document.querySelectorAll(’.inv-item’).forEach(el => el.classList.remove(‘active’));
document.querySelector(`.inv-item[data-id="${id}"]`)?.classList.add(‘active’);
document.getElementById(‘comp-elements’).value = data.elements.join(’ - ’);
document.getElementById(‘lattice-type’).value = data.lattice;
const calc = calculateLockAngle(id, data);
uniqueAngle = calc.angle;
document.getElementById(‘mass-readout’).innerText = calc.waam.toFixed(4) + “ g/mol”;
let patent = `═══ GRAVES-LAW PATENT CLAIM ═══\nSystem ${id}: ${data.name}\n\nCLAIM 1: ${data.lattice} quasicrystalline composition:\n${data.elements.map((el, i) => `  (${String.fromCharCode(97+i)}) ${el} [${(ATOMIC_MASS[el]||0).toFixed(4)} g/mol]`).join('\n')}\n\nCLAIM 2: Lock Angle: ${uniqueAngle.toFixed(6)}°\n  • Phason Strain: 0.000\n  • Vacuum Debt: ZERO\n\nCLAIM 3: ${data.detail}\n${data.molecular ? `\nMolecule: ${data.molecular}` : ''}\n\nDERIVATION:\n${calc.formula}`;
document.getElementById(‘comp-detail’).value = patent;
let atomicHtml = `<span style="color:var(--cyan);">${data.lattice.toUpperCase()}</span>`;
if(data.molecular) atomicHtml += ` <span style="color:var(--gold);">→ ${data.molecular}</span>`;
document.getElementById(‘element-list’).innerHTML = atomicHtml;
setTimeout(() => draw2DStructure(data), 50);
updateAtomTargets(data.lattice);
chaosMode = true; transitionProgress = 0; isLocked = false;
document.getElementById(‘lattice-state’).innerText = “DISORDERED”;
document.getElementById(‘lattice-state’).style.color = “#ff3333”;
atoms.forEach(a => { a.vx = (Math.random()-0.5)*8; a.vy = (Math.random()-0.5)*8; a.vz = (Math.random()-0.5)*8; });
setButtonState(“scan”);
document.getElementById(‘res-angle’).value = “–”;
document.getElementById(‘res-slack’).value = “–”;
document.getElementById(‘lock-indicator’).innerText = “READY”;
document.getElementById(‘lock-indicator’).style.color = “#555”;
drawGrid(scanCtx);
log(`SELECTED: ${data.name}`);
log(`WAAM: ${calc.waam.toFixed(4)} g/mol`, “cyan”);
log(`TARGET LOCK: ${uniqueAngle.toFixed(6)}°`, “gold”);
}

function draw2DStructure(data) {
const canvas = document.getElementById(‘atomic2dCanvas’);
if (!canvas) return;
const ctx = canvas.getContext(‘2d’);
const w = canvas.width || canvas.offsetWidth, h = canvas.height || canvas.offsetHeight;
if (w === 0 || h === 0) return;
canvas.width = w; canvas.height = h;
const cx = w / 2, cy = h / 2;
ctx.fillStyle = ‘#000’; ctx.fillRect(0, 0, w, h);
const elements = data.elements, n = elements.length;
if(n === 0) return;
let positions = [];
const radius = Math.min(w, h) * 0.35;
if(n === 1) { positions.push({x: cx, y: cy, el: elements[0]}); }
else {
positions.push({x: cx, y: cy, el: elements[0]});
for(let i = 1; i < n; i++) {
let angle = ((i-1) / (n-1)) * Math.PI * 2 - Math.PI/2;
positions.push({ x: cx + Math.cos(angle) * radius, y: cy + Math.sin(angle) * radius, el: elements[i] });
}
}
ctx.strokeStyle = ‘rgba(0, 255, 204, 0.3)’; ctx.lineWidth = 1;
for(let i = 0; i < positions.length; i++) {
for(let j = i + 1; j < positions.length; j++) {
let dist = Math.hypot(positions[i].x - positions[j].x, positions[i].y - positions[j].y);
if(dist < radius * 1.5) { ctx.beginPath(); ctx.moveTo(positions[i].x, positions[i].y); ctx.lineTo(positions[j].x, positions[j].y); ctx.stroke(); }
}
}
const atomRadius = Math.min(16, radius / 3);
positions.forEach(pos => {
let color = ELEMENT_COLORS[pos.el] || ‘#888888’;
ctx.fillStyle = color; ctx.beginPath(); ctx.arc(pos.x, pos.y, atomRadius * 0.7, 0, Math.PI * 2); ctx.fill();
ctx.fillStyle = ‘#000’; ctx.font = `bold ${Math.max(9, atomRadius * 0.6)}px monospace`; ctx.textAlign = ‘center’; ctx.textBaseline = ‘middle’; ctx.fillText(pos.el, pos.x, pos.y);
});
ctx.fillStyle = ‘#333’; ctx.font = ‘8px monospace’; ctx.textAlign = ‘left’; ctx.fillText(data.lattice, 3, h - 3);
}

function log(msg, type=’’) {
const d = document.createElement(‘div’);
d.innerHTML = `> ${msg}`;
if(type===‘cyan’) d.className = ‘log-cyan’;
if(type===‘red’) d.className = ‘log-red’;
if(type===‘gold’) d.className = ‘log-gold’;
consoleDiv.appendChild(d);
consoleDiv.scrollTop = consoleDiv.scrollHeight;
}

function drawGrid(ctx) {
const w = ctx.canvas.width, h = ctx.canvas.height;
ctx.fillStyle = ‘#000’; ctx.fillRect(0, 0, w, h);
ctx.strokeStyle = ‘#1a1a1a’; ctx.lineWidth = 1;
for(let i = 0; i <= 10; i++) { let x = (i / 10) * w; ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, h); ctx.stroke(); }
ctx.fillStyle = ‘#444’; ctx.font = ‘9px monospace’;
ctx.textAlign = ‘left’; ctx.fillText(‘5.030°’, 4, h - 4);
ctx.textAlign = ‘right’; ctx.fillText(‘5.045°’, w - 4, h - 4);
}

function runScan() {
if(!currentRank) return;
setButtonState(“scanning”);
document.getElementById(‘lock-indicator’).innerText = “SCANNING…”;
document.getElementById(‘lock-indicator’).style.color = “var(–cyan)”;
document.getElementById(‘scan-line’).style.opacity = 1;
log(`SCANNING...`, “cyan”);
let w = scanCtx.canvas.width, h = scanCtx.canvas.height, x = 0;
const MIN_SCAN = 5.030, RANGE = 0.015;
const lockX = ((uniqueAngle - MIN_SCAN) / RANGE) * w;
scanCtx.fillStyle = ‘#000’; scanCtx.fillRect(0,0,w,h); drawGrid(scanCtx);
let hasLockedDuringScan = false;
let timer = setInterval(() => {
x += 2;
document.getElementById(‘scan-line’).style.left = x + “px”;
let pct = x / w, angle = MIN_SCAN + (pct * RANGE), dist = Math.abs(angle - uniqueAngle);
let energy = Math.min(1, Math.pow(dist * 300, 2)), y = (energy * (h * 0.65)) + (h * 0.15);
scanCtx.fillStyle = (dist < 0.0004) ? “#ffffff” : “#ff3333”;
scanCtx.fillRect(x, y, 2, 2);
if (!hasLockedDuringScan && dist < 0.0004) { hasLockedDuringScan = true; triggerMonitorLock(); drawLockLine(lockX, h); }
if(x >= w) { clearInterval(timer); finishLock(uniqueAngle); }
}, 10);
}

function triggerMonitorLock() {
chaosMode = false; waveData = { entropy: [], vacuum: [] };
document.getElementById(‘entropy-val’).innerText = ‘0.001 eV’; document.getElementById(‘entropy-val’).style.color = ‘#00ff88’;
document.getElementById(‘phase-val’).innerText = ‘Δφ: 0.000’; document.getElementById(‘phase-val’).style.color = ‘#00ff88’;
document.getElementById(‘vacuum-val’).innerText = ‘0.00e-7 T’; document.getElementById(‘vacuum-val’).style.color = ‘#00ff88’;
document.getElementById(‘clk-jit’).innerText = ‘<10fs’; document.getElementById(‘clk-jit’).style.color = ‘#00ffcc’;
document.getElementById(‘clk-coh’).innerText = ‘1.000’;
}

function drawLockLine(lockX, h) {
scanCtx.strokeStyle = ‘#ffaa00’; scanCtx.lineWidth = 1; scanCtx.setLineDash([3, 3]);
scanCtx.beginPath(); scanCtx.moveTo(lockX, 0); scanCtx.lineTo(lockX, h - 16); scanCtx.stroke(); scanCtx.setLineDash([]);
scanCtx.fillStyle = ‘#ffaa00’; scanCtx.font = ‘bold 8px monospace’; scanCtx.textAlign = ‘center’; scanCtx.fillText(‘LOCK’, lockX, h - 18);
}

function finishLock(angle) {
isLocked = true;
document.getElementById(‘scan-line’).style.opacity = 0;
document.getElementById(‘lock-indicator’).innerText = “LOCKED”; document.getElementById(‘lock-indicator’).style.color = “var(–gold)”;
document.getElementById(‘lattice-state’).innerText = “LOCKED”; document.getElementById(‘lattice-state’).style.color = “#00ff88”;
document.getElementById(‘res-angle’).value = angle.toFixed(6) + “°”;
document.getElementById(‘res-slack’).value = “0.000 nm (PERFECT)”;
triggerLockTransition();
log(`LOCK CONFIRMED: ${angle.toFixed(6)}°`, “gold”);
log(`ZERO-SLACK STATE ACHIEVED.`, “cyan”);
setButtonState(“fabricate”);
}

function initAtoms() {
atoms = []; orderedPositions = [];
for(let i = 0; i < 45; i++) {
atoms.push({ x: (Math.random()-0.5)*250, y: (Math.random()-0.5)*250, z: (Math.random()-0.5)*250, vx: (Math.random()-0.5)*8, vy: (Math.random()-0.5)*8, vz: (Math.random()-0.5)*8 });
orderedPositions.push({ x: 0, y: 0, z: 0 });
}
updateAtomTargets(“Icosahedral”);
}

function updateAtomTargets(latticeType) {
const scale = 100;
if (latticeType === “Decagonal”) {
for(let k = 0; k < 5; k++) { let y = (k - 2) * 35; for(let j = 0; j < 9; j++) { let idx = k * 9 + j; if(idx < 45) { let th = (j / 9) * Math.PI * 2; orderedPositions[idx] = { x: Math.cos(th) * scale, y: y, z: Math.sin(th) * scale }; } } }
} else if (latticeType === “Pentagonal”) {
for(let i = 0; i < 45; i++) { let r = (i / 45) * scale * 1.2, th = i * (Math.PI * 2 / 5) + (i * 0.15), y = ((i % 5) - 2) * 25; orderedPositions[i] = { x: Math.cos(th) * r, y: y, z: Math.sin(th) * r }; }
} else {
const icoVerts = [];
for(let i = 0; i < 12; i++) { let lat = Math.asin(-1 + 2 * i / 11), lon = Math.sqrt(12 * Math.PI) * lat; icoVerts.push({ x: Math.cos(lat) * Math.cos(lon) * scale, y: Math.sin(lat) * scale, z: Math.cos(lat) * Math.sin(lon) * scale }); }
for(let i = 0; i < 45; i++) { let base = icoVerts[i % 12], offset = Math.floor(i / 12) * 0.25; orderedPositions[i] = { x: base.x * (1 + offset), y: base.y * (1 + offset), z: base.z * (1 + offset) }; }
}
}

function triggerLockTransition() {
transitionProgress = 0;
const duration = 1500, startTime = Date.now();
const startPositions = atoms.map(a => ({ x: a.x, y: a.y, z: a.z }));
function animate() {
const elapsed = Date.now() - startTime;
transitionProgress = Math.min(1, elapsed / duration);
const ease = 1 - Math.pow(1 - transitionProgress, 3);
atoms.forEach((a, i) => { const s = startPositions[i], t = orderedPositions[i]; a.x = s.x + (t.x - s.x) * ease; a.y = s.y + (t.y - s.y) * ease; a.z = s.z + (t.z - s.z) * ease; a.vx = 0; a.vy = 0; a.vz = 0; });
if (transitionProgress < 1) requestAnimationFrame(animate); else chaosMode = false;
}
animate();
}

function drawLoop() {
const w = atomCtx.canvas.width, h = atomCtx.canvas.height;
atomCtx.fillStyle = ‘#000’; atomCtx.fillRect(0, 0, w, h);
const t = Date.now() * 0.0003, cosT = Math.cos(t), sinT = Math.sin(t);
if (chaosMode && transitionProgress === 0) {
atomCtx.strokeStyle = ‘rgba(255, 51, 51, 0.12)’; atomCtx.lineWidth = 1;
for (let r = 0; r < Math.max(w, h); r += 35) { atomCtx.beginPath(); for (let a = 0; a <= Math.PI * 2; a += 0.1) { const z = Math.sin(r * 0.03 - t * 15) * 12; const x = w/2 + (r + z * 0.5) * Math.cos(a); const y = h/2 + (r + z * 0.5) * Math.sin(a) * 0.6; if (a === 0) atomCtx.moveTo(x, y); else atomCtx.lineTo(x, y); } atomCtx.closePath(); atomCtx.stroke(); }
}
const currentElems = currentRank ? DB[currentRank].elements : [‘C’];
if (chaosMode && transitionProgress === 0) {
atoms.forEach(a => { a.vx += (Math.random()-0.5)*5; a.vy += (Math.random()-0.5)*5; a.vz += (Math.random()-0.5)*5; a.x += a.vx; a.y += a.vy; a.z += a.vz; a.vx *= 0.9; a.vy *= 0.9; a.vz *= 0.9; const b = 120; if (Math.abs(a.x) > b) { a.x = Math.sign(a.x) * b; a.vx *= -1; } if (Math.abs(a.y) > b) { a.y = Math.sign(a.y) * b; a.vy *= -1; } if (Math.abs(a.z) > b) { a.z = Math.sign(a.z) * b; a.vz *= -1; } });
}
const projected = atoms.map((a, i) => {
const x1 = a.x * cosT - a.z * sinT, z1 = a.x * sinT + a.z * cosT;
const y1 = a.y * Math.cos(t * 0.7) - z1 * Math.sin(t * 0.7), z2 = a.y * Math.sin(t * 0.7) + z1 * Math.cos(t * 0.7);
const scale = 280 / (280 + z2);
const elem = currentElems[i % currentElems.length];
return { x: w/2 + x1 * scale, y: h/2 + y1 * scale, z: z2, r: (chaosMode && transitionProgress === 0) ? 4 : 8 * scale, elem: elem, color: ELEMENT_COLORS[elem] || ‘#888888’ };
}).sort((a, b) => a.z - b.z);
if (!chaosMode || transitionProgress > 0) {
atomCtx.lineWidth = 1.5;
for (let i = 0; i < projected.length; i++) { for (let j = i + 1; j < projected.length; j++) { const dist = Math.hypot(projected[i].x - projected[j].x, projected[i].y - projected[j].y); if (dist < 55) { atomCtx.strokeStyle = `rgba(0, 255, 204, ${(chaosMode ? transitionProgress : 1) * 0.6})`; atomCtx.beginPath(); atomCtx.moveTo(projected[i].x, projected[i].y); atomCtx.lineTo(projected[j].x, projected[j].y); atomCtx.stroke(); } } }
}
projected.forEach(p => {
if (chaosMode && transitionProgress === 0) { atomCtx.fillStyle = ‘#ff3333’; atomCtx.beginPath(); atomCtx.arc(p.x, p.y, p.r, 0, Math.PI * 2); atomCtx.fill(); }
else { atomCtx.fillStyle = p.color; atomCtx.beginPath(); atomCtx.arc(p.x, p.y, p.r * 0.75, 0, Math.PI * 2); atomCtx.fill(); atomCtx.fillStyle = ‘#000’; atomCtx.font = `bold ${Math.max(7, p.r * 0.6)}px monospace`; atomCtx.textAlign = ‘center’; atomCtx.textBaseline = ‘middle’; atomCtx.fillText(p.elem, p.x, p.y); }
});
requestAnimationFrame(drawLoop);
}

function initMonitors() {
const ec = document.getElementById(‘entropyCanvas’), pc = document.getElementById(‘phaseCanvas’), vc = document.getElementById(‘vacuumCanvas’), cc = document.getElementById(‘clockCanvas’);
if (ec && ec.offsetWidth > 0) { ec.width = ec.offsetWidth; ec.height = ec.offsetHeight || 50; entropyCtx = ec.getContext(‘2d’); }
if (pc && pc.offsetWidth > 0) { pc.width = pc.offsetWidth; pc.height = pc.offsetHeight || 50; phaseCtx = pc.getContext(‘2d’); }
if (vc && vc.offsetWidth > 0) { vc.width = vc.offsetWidth; vc.height = vc.offsetHeight || 50; vacuumCtx = vc.getContext(‘2d’); }
if (cc && cc.offsetWidth > 0) { cc.width = cc.offsetWidth; cc.height = cc.offsetHeight || 50; clockCtx = cc.getContext(‘2d’); }
}

function drawMonitors() {
const t = Date.now() * 0.01;
if (entropyCtx) {
const w = entropyCtx.canvas.width, h = entropyCtx.canvas.height;
entropyCtx.fillStyle = ‘#000’; entropyCtx.fillRect(0, 0, w, h);
if (chaosMode) { waveData.entropy.push(h/2 + (Math.random()-0.5)*24 + Math.sin(t * 0.5) * 12); if (waveData.entropy.length > w) waveData.entropy.shift(); entropyCtx.strokeStyle = ‘#ff3333’; entropyCtx.lineWidth = 1; entropyCtx.beginPath(); waveData.entropy.forEach((y, i) => i === 0 ? entropyCtx.moveTo(i, y) : entropyCtx.lineTo(i, y)); entropyCtx.stroke(); document.getElementById(‘entropy-val’).innerText = (8.2 + Math.random() * 0.5).toFixed(3) + ’ eV’; document.getElementById(‘entropy-val’).style.color = ‘#ff3333’; }
else { entropyCtx.strokeStyle = ‘#00ff88’; entropyCtx.lineWidth = 1; entropyCtx.beginPath(); for (let x = 0; x < w; x++) { entropyCtx.lineTo(x, h/2 + (Math.random()-0.5)*3); } entropyCtx.stroke(); }
}
if (phaseCtx) {
const w = phaseCtx.canvas.width, h = phaseCtx.canvas.height;
if (chaosMode) { phaseCtx.fillStyle = ‘rgba(0,0,0,0.15)’; phaseCtx.fillRect(0, 0, w, h); const x = w/2 + Math.sin(t * 0.3) * (w/3) + (Math.random()-0.5)*15; const y = h/2 + Math.cos(t * 0.4) * (h/3) + (Math.random()-0.5)*15; phaseCtx.fillStyle = ‘#ff3333’; phaseCtx.beginPath(); phaseCtx.arc(x, y, 2, 0, Math.PI * 2); phaseCtx.fill(); document.getElementById(‘phase-val’).innerText = ’Δφ: ’ + (0.8 + Math.random() * 0.2).toFixed(3); document.getElementById(‘phase-val’).style.color = ‘#ff3333’; }
else { phaseCtx.fillStyle = ‘#000’; phaseCtx.fillRect(0, 0, w, h); phaseCtx.fillStyle = ‘#00ff88’; phaseCtx.beginPath(); phaseCtx.arc(w/2, h/2, 3, 0, Math.PI * 2); phaseCtx.fill(); }
}
if (vacuumCtx) {
const w = vacuumCtx.canvas.width, h = vacuumCtx.canvas.height;
vacuumCtx.fillStyle = ‘#000’; vacuumCtx.fillRect(0, 0, w, h);
if (chaosMode) { waveData.vacuum.push(h/2 + Math.sin(t * 0.7) * 15 + (Math.random()-0.5)*15); if (waveData.vacuum.length > w) waveData.vacuum.shift(); vacuumCtx.strokeStyle = ‘#ff6633’; vacuumCtx.lineWidth = 1; vacuumCtx.beginPath(); waveData.vacuum.forEach((y, i) => i === 0 ? vacuumCtx.moveTo(i, y) : vacuumCtx.lineTo(i, y)); vacuumCtx.stroke(); document.getElementById(‘vacuum-val’).innerText = (2.1 + Math.random() * 0.3).toFixed(2) + ‘e-7 T’; document.getElementById(‘vacuum-val’).style.color = ‘#ff3333’; }
else { vacuumCtx.strokeStyle = ‘#00ffcc’; vacuumCtx.lineWidth = 1; vacuumCtx.beginPath(); for (let x = 0; x < w; x++) { vacuumCtx.lineTo(x, h/2 + (Math.random()-0.5)*2); } vacuumCtx.stroke(); }
}
if (clockCtx) {
const w = clockCtx.canvas.width, h = clockCtx.canvas.height;
clockCtx.clearRect(0, 0, w, h);
const cx = w / 2, cy = h - 5, radius = Math.min(w, h) - 10;
let grad = clockCtx.createLinearGradient(0, 0, w, 0);
if (chaosMode) { grad.addColorStop(0, ‘#ff3333’); grad.addColorStop(0.5, ‘#ffaa00’); grad.addColorStop(1, ‘#ff3333’); }
else { grad.addColorStop(0.4, ‘#003322’); grad.addColorStop(0.5, ‘#00ffcc’); grad.addColorStop(0.6, ‘#003322’); }
clockCtx.fillStyle = grad; clockCtx.beginPath(); clockCtx.arc(cx, cy, radius * 0.8, Math.PI, 0); clockCtx.fill();
let angle = -Math.PI / 2; if (chaosMode) angle += (Math.random()-0.5) * 1.5;
clockCtx.strokeStyle = ‘#fff’; clockCtx.lineWidth = 2; clockCtx.beginPath(); clockCtx.moveTo(cx, cy); clockCtx.lineTo(cx + radius * 0.7 * Math.cos(angle), cy + radius * 0.7 * Math.sin(angle)); clockCtx.stroke();
clockCtx.fillStyle = ‘#fff’; clockCtx.beginPath(); clockCtx.arc(cx, cy, 3, 0, Math.PI * 2); clockCtx.fill();
if (chaosMode) { document.getElementById(‘clk-jit’).innerText = ‘HIGH’; document.getElementById(‘clk-jit’).style.color = ‘#ff3333’; document.getElementById(‘clk-coh’).innerText = (Math.random() * 0.3).toFixed(2); }
}
requestAnimationFrame(drawMonitors);
}

function exportFabrication() {
const data = DB[currentRank];
const calc = calculateLockAngle(currentRank, data);
const timestamp = new Date().toISOString();
let elementsInfo = ‘’;
data.elements.forEach(el => { elementsInfo += `    ${el.padEnd(5)}: ${(ATOMIC_MASS[el]||0).toFixed(4)} g/mol\n`; });
let txt = `════════════════════════════════════════════════════════════════════════════════
GRAVES-LAW FABRICATION INSTRUCTIONS
════════════════════════════════════════════════════════════════════════════════

SYSTEM ID:        ${String(currentRank).padStart(3, ‘0’)}
NAME:             ${data.name}
LATTICE SYMMETRY: ${data.lattice}
TYPE:             ${data.type}

────────────────────────────────────────────────────────────────────────────────
FUNDAMENTAL CONSTANTS
────────────────────────────────────────────────────────────────────────────────

φ (Golden Ratio)             = ${PHI.toFixed(20)}
k_rat (686/461)              = ${K_RAT.toFixed(20)}
α_obs (Observed)             = ${ALPHA_OBS}
α_native (Kernel)            = ${ALPHA_NATIVE}
g(φ) = φ⁻¹² × (φ⁵/3) / k_rat = ${G_PHI.toFixed(20)}
θ_base = arcsin(√g(φ))       = ${THETA_BASE.toFixed(6)}°

────────────────────────────────────────────────────────────────────────────────
LOCK ANGLE DERIVATION
────────────────────────────────────────────────────────────────────────────────

FORMULA: ${calc.formula}

UNIQUE LOCK ANGLE = ${uniqueAngle.toFixed(6)}°

────────────────────────────────────────────────────────────────────────────────
ATOMIC COMPOSITION
────────────────────────────────────────────────────────────────────────────────

PRIMARY ELEMENTS:
${elementsInfo}
WAAM: ${calc.waam.toFixed(4)} g/mol

────────────────────────────────────────────────────────────────────────────────
SUPERPOSITION STATES
────────────────────────────────────────────────────────────────────────────────

At lock angle ${uniqueAngle.toFixed(6)}°:
Mode Φ₁: COLLAPSED - Ground State
Mode Φ₂: COLLAPSED - Ground State
Mode Φ₃: COLLAPSED - Ground State
Mode Φ₄: COLLAPSED - Ground State
Mode Φ₅: COLLAPSED - Ground State

TOTAL PHASON STRAIN: 0.000000 (ZERO-SLACK)
VACUUM DEBT: ZERO

────────────────────────────────────────────────────────────────────────────────
CERTIFICATION
────────────────────────────────────────────────────────────────────────────────

This structure:
• Incurs ZERO excess vacuum-debt
• Represents the UNIQUE ground-state configuration
• Is ENFORCED by the laws of physics at this composition
• Cannot be achieved at any other angle

Generated:  ${timestamp}
System:     Graves Validation Suite v33.0

════════════════════════════════════════════════════════════════════════════════
`;
const blob = new Blob([txt], { type: ‘text/plain;charset=utf-8’ });
const url = URL.createObjectURL(blob);
const a = document.createElement(‘a’);
a.href = url;
a.download = “FABRICATION_” + String(currentRank).padStart(3, ‘0’) + “*” + data.name.replace(/[^a-zA-Z0-9]/g, ’*’) + “.txt”;
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
log(‘FABRICATION PROTOCOL EXPORTED’, ‘gold’);
setButtonState(“reset”);
}

if (document.readyState === ‘loading’) { document.addEventListener(‘DOMContentLoaded’, init); } else { init(); }
</script>
</body>
</html>
